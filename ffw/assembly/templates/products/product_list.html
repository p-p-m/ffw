{% extends 'base.html' %}

{% load static i18n %}
{% get_media_prefix as MEDIA_PREFIX %}
{% get_static_prefix as STATIC_PREFIX %}

{% block content %}

<div>
    <!-- view-title-box -->
    <div class="view-title-box with-filters">
        <div class="wrap">
            <h1 class="view-title">
                {% if selected_subcategory %}
                    {{ selected_subcategory.name }}
                {% else %}
                    {{ selected_category.name }}
                {% endif %}
            </h1>
            <div class="filter-line">
                <ul class="filters">
                    <li class="price">{% trans 'Price' %}:</li>
                    <li><span class="filter-button gray freewidth no-check price-tag" data-role="sort-item" data-sort="PD"><i class="fa fa-chevron-up"></i></span></li>
                    <li><span class="filter-button gray freewidth no-check price-tag" data-role="sort-item" data-sort="PA"><i class="fa fa-chevron-down"></i></span></li>
                    <li>
                        <span class="filter-button" data-role="products-view-trigger" data-view="grid">
                            <span class="filter show-grid"></span>
                        </span>
                    </li>
                    <li>
                        <span class="filter-button" data-role="products-view-trigger" data-view="list">
                            <span class="filter show-list active"></span>
                        </span>
                    </li>
                </ul>
            </div>
            <div class="show-products-count">
                {% trans 'products found' %} <span data-role="count">{{ total_count }}</span>
            </div>
        </div>
    </div>
    <!-- /view-title-box -->
</div>


{% comment %}
This code duplicates filters creation that slows page rendering. It should be rewritten in more efficient way
{% endcomment %}
<div class="products-view">
    <!-- products-list-box -->
    <div class="products-list-box" data-role="products-view" data-view="grid">
        <div class="wrap">
            <div class="filters-in-view">
                {% for filter in filters %}
                    <div class="single-filter-box">
                        <h3 class="filter-title">{{ filter.name }}</h3>
                        <div class="filter-body">{% include 'filters/filter.html' %}</div>
                    </div>
                {% endfor %}
                <button class="button button-blue filter-submit" fron-state="reload-state">Show products</button>
            </div>
            <div class="products-in-view">
                <ul class="products-list" data-role="products-table" data-view-type="grid">
                    {% with products as items %}
                        {% for item in items %}
                            {% include 'items/product-grid.html' %}
                        {% endfor %}
                    {% endwith %}
                </ul>
                <div style="text-align: center; width: 100%;" data-role="show-more-block">
                    <button class="button button-blue filter-submit" data-role="show-more">Show more...</button>
                </div>
            </div>
        </div>

    </div>
    <!-- /products-list-box -->

    <!-- products-list-box -->
    <div class="products-list-box" data-role="products-view" data-view="list">
        <div class="wrap">
            <div class="filters-in-view">
                {% for filter in filters %}
                    <div class="single-filter-box">
                        <h3 class="filter-title">{{ filter.name }}</h3>
                        <div class="filter-body">{% include 'filters/filter.html' %}</div>
                    </div>
                {% endfor %}
                <button class="button button-blue filter-submit" fron-state="reload-state">Show products</button>
            </div>
            <div class="products-in-view">
                <ul class="products-list" data-role="products-table" data-view-type="list">
                    {% with products as items %}
                        {% for item in items %}
                            {% include 'items/product-list.html' %}
                        {% endfor %}
                    {% endwith %}
                </ul>
                <div style="text-align: center; width: 100%;" data-role="show-more-block">
                    <button class="button button-blue filter-submit" data-role="show-more">Show more...</button>
                </div>
            </div>
        </div>
    </div>
    <!-- /products-list-box -->

</div>

{% endblock content %}

{% block js %}
    <script src="{% static 'filters/filters.js' %}"> </script>
    <script src="{% static 'assembly/product-list.js' %}"> </script>
{% endblock js %}
